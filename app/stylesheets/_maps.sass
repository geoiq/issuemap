$maps-section-upload-width: 300px
$maps-section-padding: 20px
$maps-section-split-border: 3px
$maps-section-or-size: 34px

#maps.form
  .heading
    +clearfix
  h2
    float: left
    margin: 0 21px 21px 0
  p.description
    font-size: 12px
    line-height: 21px
    margin-top: 0
  select.column-names
    max-width: 300px
  fieldset
    background-color: $pending-form-color
    margin-bottom: 10px
    +border-radius(8px)
    .error-message
      display: none
    .inner
      padding: $maps-section-padding
  fieldset.errored
    background-color: #999
    color: white
    .error-message
      display: block
      padding: $maps-section-padding / 2
      border-bottom: $maps-section-split-border solid white
      background-color: mix(#900, $action-color)
      color: white
      +border-top-radius(8px)
  fieldset.completed
    background-color: $completed-form-color
  fieldset.location, fieldset.data
    .hint
      margin-left: 3em
      font-style: italic
      +monospace
  fieldset.import
    position: relative
    padding: 0px
    +clearfix
    .upload, .paste
      padding: $maps-section-padding ($maps-section-padding * 2)
    .upload
      float: left
      width: ($maps-section-upload-width) - ($maps-section-padding * 4) - ($maps-section-split-border / 2)
      a.file
        +dimensions(auto, 29px)
        +fancy-button($base-color)
        display: block
        line-height: 29px
        text-align: center
      .hint
        text-align: center
    .paste
      margin-left: $maps-section-upload-width - ($maps-section-split-border / 2)
      border-left: $maps-section-split-border solid white
      textarea#preprocess-paste
        display: block
        margin: 0
        padding: 0
        font-size: 8px
        +dimensions(100%, 40px)
    .or
      background-color: white
      color: $base-color
      text-align: center
      font-size: 13px
      line-height: $maps-section-or-size
      position: absolute
      top: 50%
      margin-top: -$maps-section-or-size / 2
      left: ($maps-section-upload-width) - ($maps-section-or-size / 2)
      +dimensions($maps-section-or-size, $maps-section-or-size)
      +border-radius($maps-section-or-size / 2)
      a.undo
        display: none
        +replace-text-with-dimensions("undo.png")
  fieldset.import
    &.errored
      .or
        margin-top: 21px - ($maps-section-or-size / 2)
    &.errored, &.completed
      .or .text
        display: none
      .or a.undo
        +border-radius($maps-section-or-size / 2)
        padding: ($maps-section-or-size - image-width("undo.png")) / 2 - $maps-section-split-border
        margin: $maps-section-split-border
        display: block
        +border-radius($maps-section-or-size / 2 - $maps-section-split-border)
        &:hover
          background-color: $pending-form-color
        &:active
          background-color: $completed-form-color

// Map form specifics
input#map_title
  margin-top: 5px
  width: 740px - ($maps-section-padding * 2) - ($input-padding * 2) - ($input-border-size * 2)

// Simulating a file upload button
// Specifying this to sit over the entire section instead of just the button.
// To narrow this to just the button, add a.file to the selector.
#maps.form fieldset.import .upload
  overflow: hidden
  position: relative
  direction: ltr
  input#preprocess-upload
    position: absolute
    right: 0
    top: 0px
    font-family: Arial
    font-size: 118px
    margin: 0
    padding: 0
    cursor: pointer
    +opacity(0)

$map-header-color: rgb(64, 136, 180)
$map-height: 500px
#maps.show .map
  .header
    background-color: $map-header-color
    padding: 8px 16px
    line-height: 32px
    +border-top-radius(6px)
    +clearfix
    .aux
      float: right
      line-height: 32px
      .addthis_toolbox
        float: right
        margin: 8px 0 8px 8px
      .created
        color: lighten($map-header-color, 40%)
        font-size: 12px
        float: right
    h2
      font-size: 18px
      line-height: 32px
      +text-shadow(#333, 2px, 2px, 2px)
      a
        color: #fff
        +unstyled-link(white)
  .map-wrapper
    height: $map-height
    .loading
      font-size: 24px
      line-height: $map-height
      text-align: center

$map-control-border-radius: 6px
$map-control-active-color: rgb(47, 153, 102)
#maps.show .map
  .map-wrapper
    position: relative
    .controls
      position: absolute
      top: 3px
      right: 3px
      .control.active
        background-color: $map-control-active-color
        button
          +fancy-button-colors($map-control-active-color)
        .dialog
          display: block
      .control
        float: right
        padding: 4px
        +border-top-radius($map-control-border-radius)
        button
          +fancy-button(#ccc, 12px, $map-control-border-radius / 2)
          font-weight: normal
          width: 7em
        .dialog
          display: none
          position: absolute
          left: 0
          border: 1px solid $map-control-active-color
          background-color: rgb(222, 253, 220)
          padding: 10px
          margin-top: 3px
          +border-top-right-radius($map-control-border-radius)
          +border-bottom-radius($map-control-border-radius)
      #embed-control
        .dialog
          left: auto
          right: 0
          +border-top-left-radius($map-control-border-radius)
          +border-top-right-radius(0)
        textarea
          display: block
          font-size: 8px
          overflow: hidden
          +dimensions(28em, 60px)
      #export-control
        li
          margin-top: 3px
          font-size: 12px
          font-weight: bold
          line-height: image-height("png_icon.png")
          a
            display: block
            padding-left: image-width("png_icon.png") + 12px
            background:
              repeat: no-repeat
              position: 0 50%
          a.png-export
            background-image: image-url("png_icon.png")
          a.csv-export
            background-image: image-url("csv_icon.png")
          a.kml-export
            background-image: image-url("kml_icon.png")
        li.first
          margin-top: 0
      #style-control
        +clearfix
        .dialog
          width: 120px
          padding: 14px 0 0 14px
        .palette
          width: 16px
          float: left
          margin: 0 14px 14px 0
          border-collapse: collapse
          cursor: pointer
          &.active
            +box-shadow($map-control-active-color, 0, 0, 3px, 2px)
          .color
            border: 1px solid #aaa
            width: 100%
            height: 15px
